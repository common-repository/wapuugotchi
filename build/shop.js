(()=>{"use strict";var e={n:M=>{var t=M&&M.__esModule?()=>M.default:()=>M;return e.d(t,{a:t}),t},d:(M,t)=>{for(var N in t)e.o(t,N)&&!e.o(M,N)&&Object.defineProperty(M,N,{enumerable:!0,get:t[N]})},o:(e,M)=>Object.prototype.hasOwnProperty.call(e,M)};const M=window.wp.element,t=window.wp.domReady;var N=e.n(t);const a=window.ReactJSXRuntime;function u({children:e}){return(0,a.jsx)("div",{className:"wapuugotchi_shop__menu",children:e})}const c=window.wp.data,g=window.wp.apiFetch;var i=e.n(g);const s="wapuugotchi/shop";function D(){const{svg:e}=(0,c.useSelect)((e=>({svg:e(s).getSvg()}))),t=(0,M.useMemo)((()=>e),[e]);return(0,a.jsx)("div",{className:"wapuugotchi_shop__image",children:(0,a.jsx)("div",{className:"wapuu_show_room",children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",x:"0",y:"0",version:"1.1",viewBox:"0 0 1000 1000",dangerouslySetInnerHTML:{__html:t}})})})}!function(){const e=(0,c.createReduxStore)(s,{reducer(e={},{type:M,payload:t}){switch(M){case"__SET_STATE":return{state:e,...t};case"__SET_WAPUU":return{...e,wapuu:t.wapuu,svg:t.svg};case"__SET_BALANCE":return{...e,balance:t};case"__SET_ITEMS":return{...e,items:t};case"__SET_ITEM_DETAIL":return{...e,itemDetail:t};case"__SET_SELECTED_CATEGORY":return{...e,selectedCategory:t}}return e},actions:{__initialize:e=>async function({dispatch:M,select:t}){M.__setState(e),M.setWapuu(t.getWapuu())},__setState:e=>({type:"__SET_STATE",payload:e}),setWapuu:e=>async function({dispatch:M,select:t}){const N=await async function(e,M){const t=await Promise.all(Object.keys(e.char).map((t=>((e,M,t)=>e.char?.[t]?.key?.[0]?e.char[t].key.filter((e=>M[t][e])).map((e=>M[t][e].image)):[])(e,M,t).map((e=>fetch(e))))).flat()),N=(await Promise.all(t.map((e=>e.text())))).map((e=>(new DOMParser).parseFromString(e,"image/svg+xml")));if(N.length){const e=N.splice((e=>e.querySelector("#wapuugotchi_svg__wapuu")),1)[0].querySelector("#wapuugotchi_svg__wapuu");for(const M of N)Array.from(M.querySelectorAll("g")).filter((e=>e.classList.value)).forEach((M=>{const t=e.querySelector("g#"+M.classList.value);if(t){const e=t.querySelector(".remove--part");null!==e&&e.remove(),M.removeAttribute("class"),t.append(M)}})),Array.from(M.querySelectorAll("style")).forEach((M=>{e.prepend(M)}));return e.innerHTML}}(e,t.getItems());return M.__setWapuu(e,N)},__setWapuu:(e,M)=>({type:"__SET_WAPUU",payload:{wapuu:{...e},svg:M}}),purchaseItem:e=>async function({dispatch:M,select:t}){await i()({path:"wapuugotchi/v1/wapuugotchi/shop/unlock-item",method:"POST",data:{item:{key:e.meta.key,category:t.getSelectedCategory()}}}).then((N=>{"200"===N.status&&(M.setBalance(t.getBalance()-e.meta.price),e.meta.price=0,M.setItems(t.getItems()))}))},setBalance:e=>({type:"__SET_BALANCE",payload:e}),setItems:e=>({type:"__SET_ITEMS",payload:{...e}}),showItemDetail:e=>({type:"__SET_ITEM_DETAIL",payload:e}),setSelectedCategory:e=>({type:"__SET_SELECTED_CATEGORY",payload:e})},selectors:{__getState:e=>e,getItems:e=>e.items,getCategories:e=>e.categories,getWapuu:e=>e.wapuu,getSvg:e=>e.svg,getBalance:e=>e.balance,getItemDetail:e=>e.itemDetail,getSelectedCategory:e=>e.selectedCategory}});(0,c.register)(e)}();const j=window.wp.i18n,o=window.wp.components;function T(){const{itemDetail:e,items:t,selectedCategory:N}=(0,c.useSelect)((e=>({itemDetail:e(s).getItemDetail(),selectedCategory:e(s).getSelectedCategory(),items:e(s).getItems()}))),{showItemDetail:u,purchaseItem:g}=(0,c.useDispatch)(s),i=t?.[N]?.[e],D=(0,M.useCallback)((()=>{g(i),u(null)}),[g,u,i]),T=(0,M.useCallback)((()=>{u(null)}),[u]);return(0,a.jsx)(a.Fragment,{children:null!==e&&void 0!==i?.meta&&(0,a.jsx)("div",{className:"wapuugotchi_shop__overlay",children:(0,a.jsxs)(o.__experimentalConfirmDialog,{className:"wapuu_payment__confirm_dialog",onConfirm:D,onCancel:T,children:[(0,a.jsx)("h2",{className:"wapuu_payment__item_name",children:i?.meta?.name}),(0,a.jsxs)("div",{className:"wapuu_payment__item_preview",children:[(0,a.jsx)("img",{src:i?.preview}),(0,a.jsx)("span",{className:"wapuu_payment__info_icon dashicons dashicons-info"}),(0,a.jsxs)("div",{className:"wapuu_payment__item_tooltip",children:[(0,a.jsx)("div",{className:"wapuu_payment__item_tooltip_shadow"}),(0,a.jsx)("p",{className:"wapuu_payment__item_tooltip_text",children:i?.meta?.description}),(0,a.jsxs)("p",{className:"wapuu_payment__item_tooltip_author",children:["Discoverer: ",i?.meta?.author]})]})]}),(0,a.jsx)("p",{className:"wapuu_payment__confirm_text",children:(0,j.__)("Do you want to buy this item?","wapuugotchi")})]})})})}window.React;const n="data:image/svg+xml;base64,PHN2ZwoJd2lkdGg9IjE3IgoJaGVpZ2h0PSIxMiIKCXZpZXdCb3g9IjAgMCAxNyAxMiIKCWZpbGw9Im5vbmUiCgl4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCj4KCTxwYXRoCgkJZD0iTTguODk2NDcgNC4yMzkyNkM2Ljc1OTcxIDQuMjM5MjYgNS4wMTYxMSA1Ljk4Mjg5IDUuMDE2MTEgOC4xMTk2MkM1LjAxNjExIDEwLjI1NjQgNi43NTk3NCAxMiA4Ljg5NjQ3IDEyQzExLjAzMzIgMTIgMTIuNzc2OCAxMC4yNTY0IDEyLjc3NjggOC4xMTk2MkMxMi43NzY4IDUuOTgyOTggMTEuMDMzMiA0LjIzOTI2IDguODk2NDcgNC4yMzkyNlpNMTAuNzQyNiA4LjY0OTU0QzEwLjQ1MjEgOC42NDk1NCAxMC4yMTI4IDguNDEwMjMgMTAuMjEyOCA4LjExOTY1QzEwLjIxMjggNy40MDE3IDkuNjE0NCA2LjgwMzM3IDguODk2NDcgNi44MDMzN0M4LjYwNTg5IDYuODAzMzcgOC4zNjY1OSA2LjU2NDA2IDguMzY2NTkgNi4yNzM0OUM4LjM2NjU5IDUuOTgyOSA4LjYwNTkgNS43NDM2IDguODk2NDcgNS43NDM2QzEwLjIxMjggNS43NDM2IDExLjI4OTYgNi44MjA1NiAxMS4yODk2IDguMTM2NzFDMTEuMjg5NiA4LjQxMDI1IDExLjA1MDMgOC42NDk1NyAxMC43NDI2IDguNjQ5NTdWOC42NDk1NFoiCgkJZmlsbD0iI0ZGRkZGRiIKCS8+Cgk8cGF0aAoJCWQ9Ik02LjI0Njk4IDMuMTExMTFDNi4zMzI0NyAzLjMxNjIgNi41Mzc1NiAzLjQzNTkzIDYuNzQyNjQgMy40MzU5M0M2LjgxMDk3IDMuNDM1OTMgNi44Nzk0MSAzLjQxODg4IDYuOTQ3NzQgMy40MDE3MUM3LjIyMTI3IDMuMjgxOTkgNy4zNTgwMyAyLjk3NDM1IDcuMjM4MzIgMi43MDA4Mkw2LjcyNTQ3IDEuNDcwMDRDNi42MDU3NSAxLjE5NjUxIDYuMjk4MTIgMS4wNzY5MSA2LjAyNDU4IDEuMTc5NDZDNS43NTEwNSAxLjI5OTE3IDUuNjE0MjkgMS42MDY4MSA1LjczNCAxLjg4MDM1TDYuMjQ2OTggMy4xMTExMVoiCgkJZmlsbD0iI0ZGRkZGRiIKCS8+Cgk8cGF0aAoJCWQ9Ik01LjI4OTY3IDMuNzQzNTVMMy45MjIxMSAyLjM3NTk5QzMuNzE3MDEgMi4xNzA4OSAzLjM3NTAzIDIuMTcwODkgMy4xNjk5NCAyLjM3NTk5QzIuOTY0ODQgMi41ODEwOCAyLjk2NDg0IDIuOTIzMDYgMy4xNjk5NCAzLjEyODE2TDQuNTM3NDkgNC40OTU3MkM0LjY0MDA0IDQuNTk4MjYgNC43NzY4MSA0LjY0OTU0IDQuOTEzNTYgNC42NDk1NEM1LjA1MDMyIDQuNjQ5NTQgNS4xODcxIDQuNTk4MjYgNS4yODk2MyA0LjQ5NTcyQzUuNDk0NzMgNC4yOTA2MiA1LjQ5NDc2IDMuOTY1ODMgNS4yODk2NyAzLjc0MzU1WiIKCQlmaWxsPSIjRkZGRkZGIgoJLz4KCTxwYXRoCgkJZD0iTTMuODg3ODMgNS40N0wyLjY1NzA2IDQuOTU3MTVDMi4zODM1MyA0LjgzNzQzIDIuMDc1ODkgNC45NzQyIDEuOTU2MTcgNS4yNDc3M0MxLjgzNjQ1IDUuNTIxMjYgMS45NzMyMiA1LjgyODkgMi4yNDY3NSA1Ljk0ODYyTDMuNDc3NTMgNi40NjE0N0MzLjU0NTg1IDYuNDk1NjkgMy42MTQzIDYuNDk1NjkgMy42ODI2MiA2LjQ5NTY5QzMuODg3NzIgNi40OTU2OSA0LjA5MjkxIDYuMzc1OTggNC4xNzgyOSA2LjE3MDg3QzQuMjgwOTYgNS44OTczNCA0LjE2MTI1IDUuNTcyNTMgMy44ODc4MyA1LjQ3WiIKCQlmaWxsPSIjRkZGRkZGIgoJLz4KCTxwYXRoCgkJZD0iTTMuNzg1MzYgOC4xMTk2MUMzLjc4NTM2IDcuODI5MDIgMy41NDYwNSA3LjU4OTcyIDMuMjU1NDcgNy41ODk3MkwxLjMwNjc0IDcuNTg5NkMxLjAxNjE2IDcuNTg5NiAwLjc3Njg1NSA3LjgyODkxIDAuNzc2ODU1IDguMTE5NDlDMC43NzY4NTUgOC40MTAwNiAxLjAxNjE3IDguNjQ5MzcgMS4zMDY3NCA4LjY0OTM3TDMuMjU1NDcgOC42NDk0OUMzLjU0NjA1IDguNjQ5NDkgMy43ODUzNiA4LjQxMDE4IDMuNzg1MzYgOC4xMTk2MVoiCgkJZmlsbD0iI0ZGRkZGRiIKCS8+Cgk8cGF0aAoJCWQ9Ik0zLjQ3NzUyIDkuNzk0NzdMMi4yNDY3NSAxMC4zMDc2QzEuOTczMjEgMTAuNDI3MyAxLjgzNjQ2IDEwLjczNSAxLjk1NjE2IDExLjAwODVDMi4wNDE2NiAxMS4yMTM2IDIuMjQ2NzUgMTEuMzMzMyAyLjQ1MTgzIDExLjMzMzNDMi41MjAxNiAxMS4zMzMzIDIuNTg4NiAxMS4zMTYzIDIuNjU2OTIgMTEuMjk5MUwzLjg4NzcgMTAuNzg2M0M0LjE2MTIzIDEwLjY2NjUgNC4yOTc5OSAxMC4zNTg5IDQuMTc4MjggMTAuMDg1NEM0LjA1ODY5IDkuODExODQgMy43NTEwNiA5LjY3NTA3IDMuNDc3NTIgOS43OTQ3N1oiCgkJZmlsbD0iI0ZGRkZGRiIKCS8+Cgk8cGF0aAoJCWQ9Ik0xNS41NDYgMTAuMjkwNkwxNC4zMTUzIDkuNzc3N0MxNC4wNDE3IDkuNjU3OTkgMTMuNzM0MSA5Ljc5NDc1IDEzLjYxNDQgMTAuMDY4M0MxMy40OTQ3IDEwLjM0MTggMTMuNjMxNCAxMC42NDk1IDEzLjkwNSAxMC43NjkyTDE1LjEzNTcgMTEuMjgyQzE1LjIwNDEgMTEuMzE2MyAxNS4yNzI1IDExLjMxNjMgMTUuMzQwOCAxMS4zMTYzQzE1LjU0NTkgMTEuMzE2MyAxNS43NTExIDExLjE5NjUgMTUuODM2NSAxMC45OTE0QzE1LjkzOTIgMTAuNzE3OSAxNS44MTk2IDEwLjQxMDMgMTUuNTQ2IDEwLjI5MDZaIgoJCWZpbGw9IiNGRkZGRkYiCgkvPgoJPHBhdGgKCQlkPSJNMTYuNDg2NCA3LjU4OTg0SDE0LjUzNzdDMTQuMjQ3MSA3LjU4OTg0IDE0LjAwNzggNy44MjkxNiAxNC4wMDc4IDguMTE5NzNDMTQuMDA3OCA4LjQxMDMxIDE0LjI0NzEgOC42NDk2MiAxNC41Mzc3IDguNjQ5NjJIMTYuNDY5NEMxNi43NTk5IDguNjQ5NjIgMTYuOTk5MyA4LjQxMDMxIDE2Ljk5OTMgOC4xMTk3M0MxNy4wMTYzIDcuODI5MjcgMTYuNzc3IDcuNTg5ODQgMTYuNDg2NCA3LjU4OTg0SDE2LjQ4NjRaIgoJCWZpbGw9IiNGRkZGRkYiCgkvPgoJPHBhdGgKCQlkPSJNMTMuNjE0NSA2LjE3MTAyQzEzLjcgNi4zNzYxMSAxMy45MDUxIDYuNDk1ODQgMTQuMTEwMiA2LjQ5NTg0QzE0LjE3ODUgNi40OTU4NCAxNC4yNDY5IDYuNDc4NzkgMTQuMzE1MyA2LjQ2MTYyTDE1LjU0NiA1Ljk0ODc2QzE1LjgxOTYgNS44MjkwNSAxNS45NTYzIDUuNTIxNDEgMTUuODM2NiA1LjI0Nzg3QzE1LjcxNjkgNC45NzQzNCAxNS40MDkzIDQuODU0NzQgMTUuMTM1NyA0Ljk1NzI5TDEzLjkwNSA1LjQ3MDE0QzEzLjYzMTcgNS41NzI2OSAxMy41MTIgNS44OTc0OCAxMy42MTQ1IDYuMTcxMDJaIgoJCWZpbGw9IiNGRkZGRkYiCgkvPgoJPHBhdGgKCQlkPSJNMTQuNjM5OCAyLjM3NTk5QzE0LjQzNDcgMi4xNzA4OSAxNC4wOTI3IDIuMTcwODkgMTMuODg3NiAyLjM3NTk5TDEyLjUyIDMuNzQzNTVDMTIuMzE0OSAzLjk0ODY0IDEyLjMxNDkgNC4yOTA2MiAxMi41MiA0LjQ5NTcyQzEyLjYyMjYgNC41OTgyNiAxMi43NTkzIDQuNjQ5NTQgMTIuODk2MSA0LjY0OTU0QzEzLjAzMjkgNC42NDk1NCAxMy4xNjk2IDQuNTk4MjYgMTMuMjcyMiA0LjQ5NTcyTDE0LjYzOTcgMy4xMjgxNkMxNC44NDQ4IDIuOTIyOTUgMTQuODQ0OSAyLjU4MTA5IDE0LjYzOTggMi4zNzU5OVoiCgkJZmlsbD0iI0ZGRkZGRiIKCS8+Cgk8cGF0aAoJCWQ9Ik0xMC44NDUxIDMuNDAxODJDMTAuOTEzNCAzLjQzNjA0IDEwLjk4MTkgMy40MzYwNCAxMS4wNTAyIDMuNDM2MDRDMTEuMjU1MyAzLjQzNjA0IDExLjQ2MDUgMy4zMTYzMiAxMS41NDU5IDMuMTExMjJMMTIuMDU4NyAxLjg4MDQ1QzEyLjE3ODQgMS42MDY5MSAxMi4wNDE3IDEuMjk5MjggMTEuNzY4MSAxLjE3OTU2QzExLjQ5NDYgMS4wNTk4NCAxMS4xODcgMS4xOTY2MSAxMS4wNjcyIDEuNDcwMTRMMTAuNTU0NCAyLjcwMDkyQzEwLjQ1MiAyLjk3NDQ1IDEwLjU3MTYgMy4yODIyMiAxMC44NDUxIDMuNDAxODJaIgoJCWZpbGw9IiNGRkZGRkYiCgkvPgoJPHBhdGgKCQlkPSJNOC44OTY1OSAzLjAwODVDOS4xODcxNyAzLjAwODUgOS40MjY0NyAyLjc2OTE5IDkuNDI2NDcgMi40Nzg2MVYwLjUyOTg4N0M5LjQyNjQ3IDAuMjM5MzAyIDkuMTg3MTYgMCA4Ljg5NjU5IDBDOC42MDYwMSAwIDguMzY2NyAwLjIzOTMxMSA4LjM2NjcgMC41Mjk4ODdWMi40NjE1NUM4LjM2NjcgMi43NjkxOCA4LjYwNjAxIDMuMDA4NSA4Ljg5NjU5IDMuMDA4NVoiCgkJZmlsbD0iI0ZGRkZGRiIKCS8+Cjwvc3ZnPgo=";function r(){const{balance:e}=(0,c.useSelect)((e=>({balance:e(s).getBalance()})));return(0,a.jsxs)("div",{className:"wapuugotchi_shop__header",children:[(0,a.jsx)("h1",{className:"wapuugotchi_shop__title",children:(0,j.__)("Customize Your Wapuu with WapuuGotchi","wapuugotchi")}),(0,a.jsxs)("span",{className:"wapuugotchi_shop__pearls",children:[(0,j.__)("Your Pearl Balance:","wapuugotchi"),(0,a.jsx)("img",{alt:"",src:n}),e]})]})}function l(){const{wapuu:e,svg:t}=(0,c.useSelect)((e=>({wapuu:e(s).getWapuu(),svg:e(s).getSvg()}))),[N,u]=(0,M.useState)(e?.name),[g,D]=(0,M.useState)((0,j.__)("Save","wapuugotchi"));return(0,a.jsxs)("div",{className:"wapuugotchi_shop__control_panel",children:[(0,a.jsx)("input",{className:"wapuugotchi_shop__name",type:"text",value:N,onChange:e=>u(e.target.value)}),(0,a.jsx)("button",{className:"button button-primary wapuugotchi_shop__submit",onClick:async M=>{var a;M.preventDefault(),D((0,j.__)("Saving…","wapuugotchi")),e.name=N,await i()({path:"wapuugotchi/v1/wapuugotchi/shop/update-avatar",method:"POST",data:{avatar:e,svg:(a=t,'<svg xmlns="http://www.w3.org/2000/svg" x="0" y="0" version="1.1" viewBox="0 0 1000 1000">'+a+"</svg>")}}),D((0,j.__)("Save","wapuugotchi"))},children:g})]})}function I({children:e}){return(0,a.jsx)("div",{className:"wapuugotchi_shop__customizer",children:e})}function y({slug:e,meta:M}){const{selectedCategory:t}=(0,c.useSelect)((e=>({selectedCategory:e(s).getSelectedCategory()})));return M&&(0,a.jsx)("div",{onClick:()=>(async()=>{(0,c.dispatch)(s).setSelectedCategory(e)})(),id:"category_"+e,className:e===t?"wapuugotchi_shop__category selected":"wapuugotchi_shop__category",children:(0,a.jsx)("img",{className:"wapuugotchi_shop__category_icon",src:M.image})})}function x(){const{categories:e}=(0,c.useSelect)((e=>({categories:e(s).getCategories()})));return(0,a.jsx)("div",{className:"wapuugotchi_shop__categories",children:Object.keys(e).map((M=>(0,a.jsx)(y,{slug:M,meta:e[M]},M)))})}function p({uuid:e,item:t}){const{wapuu:N,balance:u,selectedCategory:g}=(0,c.useSelect)((e=>({wapuu:e(s).getWapuu(),balance:e(s).getBalance(),selectedCategory:e(s).getSelectedCategory()}))),i=(0,M.useCallback)((()=>{const M=N?.char?.[g];if(0===t.meta.price){const t=M?.key?.includes(e),a=M.key.length>M.min,u=M.key.length<M.max;if(t&&a){const t=M.key.indexOf(e);M.key.splice(t,1),(0,c.dispatch)(s).setWapuu(N)}else!t&&u?(M.key.push(e),(0,c.dispatch)(s).setWapuu(N)):t||u||(M.key.pop(),M.key.push(e),(0,c.dispatch)(s).setWapuu(N))}else t.meta.price<=u&&(0,c.dispatch)(s).showItemDetail(e)}),[u,t,g,e,N]);return(0,a.jsxs)("div",{onClick:i,className:`${N?.char?.[g]?.key?.includes(e)?"wapuugotchi_shop__item selected":"wapuugotchi_shop__item"}${0===t?.meta?.price?" free":""}`,children:[(0,a.jsx)("img",{src:t.preview,alt:"Placeholder"}),t?.meta?.price>0&&(0,a.jsxs)("div",{className:"wapuugotchi_shop__price",children:[(0,a.jsx)("img",{src:n}),(0,a.jsx)("span",{children:t.meta.price})]})]})}function z(){const{selectedCategory:e,items:M}=(0,c.useSelect)((e=>({items:e(s).getItems(),selectedCategory:e(s).getSelectedCategory()})));return(0,a.jsx)("div",{className:"wapuugotchi_shop__items",children:Object.keys(M?.[e]).map((t=>(0,a.jsx)(p,{uuid:t,item:M?.[e]?.[t]},t)))})}function A({children:e}){return(0,a.jsx)("div",{className:"wapuugotchi_shop__customizer_right",children:e})}function _({children:e}){return(0,a.jsx)("div",{className:"wapuugotchi_shop__customizer_left",children:e})}function k(){return(0,a.jsxs)("div",{className:"wapuugotchi_shop",children:[(0,a.jsx)(r,{},"header"),(0,a.jsx)(T,{},"payment-dialog"),(0,a.jsxs)(I,{children:[(0,a.jsx)(_,{children:(0,a.jsxs)(u,{children:[(0,a.jsx)(x,{},"categories"),(0,a.jsx)(z,{},"items")]},"menu")},"left-side"),(0,a.jsxs)(A,{children:[(0,a.jsx)(l,{},"control-panel"),(0,a.jsx)(D,{},"show-room")]},"right-side")]},"customizer")]})}N()((()=>(0,M.createRoot)(document.getElementById("wapuugotchi-submenu__shop")).render((0,a.jsx)(M.StrictMode,{children:(0,a.jsx)(k,{})}))))})();